import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,b as i,e as p,w as a,r as u,o as d,a as n,d as s}from"./app-C80Pz9_H.js";const k={};function h(v,e){const c=u("Tabs");return d(),r("div",null,[e[10]||(e[10]=i('<p>In Stone.js, <strong>Service Providers</strong> are the official mechanism for plugging functionality into the <strong>initialization dimension</strong>, the moment when the system constructs its internal execution context and binds all core services before handling any request, command, or event.</p><p>They are not the only extension point in Stone.js, but they are the main one for <strong>initialization</strong>.<br> Other dimensions (like <strong>setup</strong> and <strong>integration</strong>) have their own mechanisms. The service provider belongs solely to the phase where the application is “coming to life.”</p><p>A <strong>service provider</strong> is a specialized module that can:</p><ul><li>Register services into the container</li><li>Configure those services once registered</li><li>Attach to system lifecycle hooks</li><li>Extend the system dynamically during initialization</li></ul><p>However, in most cases, you won’t need one.</p><p>Stone.js favors declarative configuration via <strong>decorators</strong> and imperative configuration via the <strong>blueprint API</strong>. These should be your first tools.<br> Reach for a service provider only when you need <strong>explicit</strong>, <strong>fine-grained</strong>, or <strong>programmatic control</strong> over how services are wired, or when building a <strong>third-party package</strong> that needs to extend the system in a reusable way.</p><p>Providers are especially useful when:</p><ul><li>You’re registering complex services with runtime logic</li><li>You want to encapsulate feature modules for reuse</li><li>You’re distributing an integration or package for others to use</li><li>You need a consistent location to access lifecycle hooks (<code>onInit</code>, <code>onStart</code>, etc.)</li></ul><p>In summary:</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Stone.js can be extended in many ways, but the service provider is the main one for the initialization dimension.</p></div><p>It’s your bridge into the internal execution context, and your tool of choice when configuration turns into orchestration.</p><h2 id="using-service-provider" tabindex="-1"><a class="header-anchor" href="#using-service-provider"><span>Using Service Provider</span></a></h2><p>Service providers in Stone.js come in two variants: <strong>class-based</strong> and <strong>factory-based</strong>.<br> Both are valid and first-class citizens in the system, but each serves different needs.</p><p>What matters is <strong>what</strong> a provider does: it must implement one or both of these methods:</p><ul><li><code>register()</code> → bind services, listeners, etc.</li><li><code>boot()</code> → configure services after all providers have registered</li></ul><p>These methods can be synchronous or asynchronous.<br> And depending on your use case, you might choose one variant over the other.</p>',16)),p(c,{data:[{id:"Class-based"},{id:"Factory-based"},{id:"Function-based"}],active:0,"tab-id":"class-factory-function"},{title0:a(({value:t,isActive:o})=>e[0]||(e[0]=[s("Class-based")])),title1:a(({value:t,isActive:o})=>e[1]||(e[1]=[s("Factory-based")])),title2:a(({value:t,isActive:o})=>e[2]||(e[2]=[s("Function-based")])),tab0:a(({value:t,isActive:o})=>e[3]||(e[3]=[n("h3",{id:"class-based-providers",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#class-based-providers"},[n("span",null,"Class-Based Providers")])],-1),n("p",null,[s("This is the most common shape, and the only one that supports "),n("strong",null,"decorators"),s(" and "),n("strong",null,"lifecycle hooks"),s(".")],-1),n("p",null,"A class-based provider:",-1),n("ul",null,[n("li",null,[s("Can inject the "),n("code",null,"IContainer"),s(" in its constructor")]),n("li",null,[s("Can define "),n("code",null,"register()"),s(" and/or "),n("code",null,"boot()"),s(" as instance methods")])],-1),n("div",{class:"language-typescript line-numbers-mode","data-highlighter":"prismjs","data-ext":"ts"},[n("pre",null,[n("code",{class:"language-typescript"},[n("span",{class:"line"},[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" IContainer"),n("span",{class:"token punctuation"},","),s(" IServiceProvider "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'@stone-js/core'")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"AppServiceProvider"),s(),n("span",{class:"token keyword"},"implements"),s(),n("span",{class:"token class-name"},"IServiceProvider"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"constructor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token keyword"},"readonly"),s(" container"),n("span",{class:"token operator"},":"),s(" IContainer"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"register"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("container")]),s(`
`),n("span",{class:"line"},[s("      "),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"singletonIf"),n("span",{class:"token punctuation"},"("),s("MyService"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("c"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"MyService"),n("span",{class:"token punctuation"},"("),s("c"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("      "),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"alias"),n("span",{class:"token punctuation"},"("),s("MyService"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'myService'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"boot"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),s("container"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"make"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'myService'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"initialize"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"})])]),n("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),tab1:a(({value:t,isActive:o})=>e[4]||(e[4]=[n("h3",{id:"factory-based-providers",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#factory-based-providers"},[n("span",null,"Factory-Based Providers")])],-1),n("p",null,"Factory-based providers offer an alternative for simpler setups or when you want to define everything inline.",-1),n("p",null,[s("A factory provider is just a function that returns an object with a "),n("code",null,"register()"),s(" or "),n("code",null,"boot()"),s(" method.")],-1),n("div",{class:"language-typescript line-numbers-mode","data-highlighter":"prismjs","data-ext":"ts"},[n("pre",null,[n("code",{class:"language-typescript"},[n("span",{class:"line"},[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" FactoryServiceProvider"),n("span",{class:"token punctuation"},","),s(" IContainer "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'@stone-js/core'")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"const"),s(" AppServiceProvider"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token function-variable function"},"FactoryServiceProvider"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),s("container"),n("span",{class:"token operator"},":"),s(" IContainer"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"register"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},"    container"),s(`
`),n("span",{class:"line"},[s("      "),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"singletonIf"),n("span",{class:"token punctuation"},"("),s("MyService"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("c"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"MyService"),n("span",{class:"token punctuation"},"("),s("c"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("      "),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"alias"),n("span",{class:"token punctuation"},"("),s("MyService"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'myService'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"boot"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    container"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"make"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'myService'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"initialize"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"})])]),n("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("p",null,"This shape is ideal for libraries, or simple modules that don’t need decorators or class behavior.",-1)])),tab2:a(({value:t,isActive:o})=>e[5]||(e[5]=[n("h3",{id:"no-function-based-providers",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#no-function-based-providers"},[n("span",null,"No Function-Based Providers")])],-1),n("p",null,"You may wonder: why not allow raw functions?",-1),n("p",null,[s("Because the provider system is lifecycle-aware, and lifecycle awareness requires structure."),n("br"),s(" A plain function can’t express "),n("code",null,"register"),s(", "),n("code",null,"boot"),s(", or hooks reliably. So to stay coherent with the Continuum, Stone.js only accepts "),n("strong",null,"class-based"),s(" and "),n("strong",null,"factory-based"),s(" variants.")],-1)])),_:1}),e[11]||(e[11]=i(`<h2 id="lifecycle-methods" tabindex="-1"><a class="header-anchor" href="#lifecycle-methods"><span>Lifecycle Methods</span></a></h2><p>A service provider’s power lies in <strong>when</strong> it does things, not just <strong>what</strong> it does.</p><p>Stone.js executes all providers during the <strong>initialization phase</strong>, the moment your system is “bootstrapping” itself into a running app. This phase is split into two key steps:</p><ul><li><code>register()</code> → Bind things into the service container.</li><li><code>boot()</code> → Configure or activate them once all bindings are available.</li></ul><p>Both are <strong>optional</strong>. But you must implement at least one of them to make your provider useful.</p><h3 id="register" tabindex="-1"><a class="header-anchor" href="#register"><span><code>register()</code></span></a></h3><p>The <code>register()</code> method is used to bind services, classes, values, and factories into the service container.<br> This is where you describe <strong>what your provider offers</strong>, not how it behaves.</p><p>At this stage:</p><ul><li>Your provider can access the service container</li><li>No other provider’s <code>boot()</code> method has run yet</li><li>You <strong>should not resolve or use</strong> other services, just bind them</li><li>You have access to the <code>blueprint</code> and the <code>eventEmitter</code></li></ul><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyServiceProvider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">register</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container</span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;router&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>container<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token string">&#39;apiOptions&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> apiUrl<span class="token operator">:</span> <span class="token string">&#39;https://api.example.com&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This ensures the system builds a complete registry before any configuration or execution begins.</p><h3 id="boot" tabindex="-1"><a class="header-anchor" href="#boot"><span><code>boot()</code></span></a></h3><p>Once all providers have been registered, Stone.js calls their <code>boot()</code> methods, in the order they were loaded.</p><p>Now is the time to:</p><ul><li>Resolve services (<code>container.make(...)</code>)</li><li>Register routes</li><li>Set event listeners</li><li>Configure middleware</li></ul><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyServiceProvider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">boot</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&#39;router&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    router<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>routeDefinitions<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>boot()</code> phase is the safe place to <strong>use</strong> the things you registered earlier, or to coordinate logic between multiple providers.</p><h3 id="hooks-hook" tabindex="-1"><a class="header-anchor" href="#hooks-hook"><span>Hooks (<code>@Hook</code>)</span></a></h3><p>Stone.js supports a lifecycle hook system, and providers are the best place to listen to major system events.</p><p>This works only with <strong>class-based providers</strong>, using the <code>@Hook</code> decorator:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Hook <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@stone-js/core&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyServiceProvider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Hook</span></span><span class="token punctuation">(</span><span class="token string">&#39;onInit&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">logInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Execution context initialized.&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This makes your providers reactive and introspectable, and allows third-party packages to extend the framework behavior in clean, declarative ways.</p><p>You can subscribe to any of the documented <a href="./blueprint#setup-hooks">setup</a>, <a href="./adapter#integration-hooks">integration</a>, or <a href="./lifecycle">initialization</a> hooks. It’s one more reason to use class-based providers when you need deep integration.</p><h2 id="accessing-the-service-container" tabindex="-1"><a class="header-anchor" href="#accessing-the-service-container"><span>Accessing the Service Container</span></a></h2><p>The service container is the beating heart of your Stone.js application, and service providers are its surgeons.<br> But timing matters: <strong>not everything is available all the time</strong>.</p><h3 id="constructor-access" tabindex="-1"><a class="header-anchor" href="#constructor-access"><span>Constructor Access</span></a></h3><p>In class-based providers, the service container is injected via the constructor, and via the function argument in factory-based providers.<br> This lets you store and reuse it across <code>register()</code>, <code>boot()</code>, and hook methods.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> IContainer<span class="token punctuation">,</span> IServiceProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@stone-js/core&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyServiceProvider</span> <span class="token keyword">implements</span> <span class="token class-name">IServiceProvider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> container<span class="token operator">:</span> IContainer<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container important"><p class="hint-container-title">Important</p><p>But be careful: at construction time, only the <strong>blueprint</strong> and the <strong>event emitter</strong> are available, <strong>no other services are registered yet</strong>. Don’t try to <code>make()</code> anything else in the constructor, wait for <code>boot()</code>.</p></div><h3 id="what-s-safe-to-use-and-when" tabindex="-1"><a class="header-anchor" href="#what-s-safe-to-use-and-when"><span>What’s Safe to Use (and When)</span></a></h3><table><thead><tr><th>Method</th><th>Can bind services</th><th>Can resolve services</th><th>Has all providers registered?</th></tr></thead><tbody><tr><td><code>constructor()</code></td><td>❌</td><td>❌</td><td>❌</td></tr><tr><td><code>register()</code></td><td>✅</td><td>⚠️<em>only your own</em></td><td>❌</td></tr><tr><td><code>boot()</code></td><td>✅</td><td>✅</td><td>✅</td></tr></tbody></table><p>So the rule is simple:</p><ul><li><strong>Register early</strong> (<code>register()</code>)</li><li><strong>Configure late</strong> (<code>boot()</code>)</li></ul><p>That’s the continuum between <strong>definition</strong> and <strong>activation</strong>, don’t mix them up.</p><h3 id="common-container-patterns" tabindex="-1"><a class="header-anchor" href="#common-container-patterns"><span>Common Container Patterns</span></a></h3><p>You’ll mostly use three methods:</p><ul><li><code>singletonIf(key, factory)</code> – registers a singleton only if not yet registered</li><li><code>instanceIf(key, value)</code> – registers a static instance only if not yet registered</li><li><code>make(key)</code> – resolves a previously registered item</li></ul><p>They allow your provider to be modular and respectful of other providers’ boundaries.</p><h2 id="registering-providers" tabindex="-1"><a class="header-anchor" href="#registering-providers"><span>Registering Providers</span></a></h2><p>Creating a provider is just the first step.<br> To make it part of the system, you need to <strong>register it</strong>, either <strong>declaratively</strong> or <strong>imperatively</strong>.</p><p>Stone.js offers both options, so you can pick what fits your architecture and context best.</p>`,41)),p(c,{data:[{id:"Declarative"},{id:"Imperative"}],active:0,"tab-id":"declarative-imperative"},{title0:a(({value:t,isActive:o})=>e[6]||(e[6]=[s("Declarative")])),title1:a(({value:t,isActive:o})=>e[7]||(e[7]=[s("Imperative")])),tab0:a(({value:t,isActive:o})=>e[8]||(e[8]=[n("h3",{id:"declarative-registration",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#declarative-registration"},[n("span",null,"Declarative Registration")])],-1),n("p",null,[s("For most applications, this is the go-to method."),n("br"),s(" Just decorate your class with "),n("code",null,"@Provider()"),s(", and Stone.js will detect and load it automatically.")],-1),n("div",{class:"language-typescript line-numbers-mode","data-highlighter":"prismjs","data-ext":"ts"},[n("pre",null,[n("code",{class:"language-typescript"},[n("span",{class:"line"},[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" Provider "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'@stone-js/core'")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token decorator"},[n("span",{class:"token at operator"},"@"),n("span",{class:"token function"},"Provider")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"MyServiceProvider"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"register"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// Bind services here")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token function"},"boot"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// Configure them here")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"})])]),n("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("p",null,[n("strong",null,"When to use it:")],-1),n("ul",null,[n("li",null,"When the provider is part of your app codebase"),n("li",null,"When you want automatic integration"),n("li",null,[s("When you want to use hooks ("),n("code",null,"@Hook"),s(") or decorators")])],-1),n("p",null,"Under the hood, the decorator tells Stone.js to include this provider during the app’s initialization phase.",-1)])),tab1:a(({value:t,isActive:o})=>e[9]||(e[9]=[n("h3",{id:"imperative-registration",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#imperative-registration"},[n("span",null,"Imperative Registration")])],-1),n("p",null,[s("Need more control? Want to include third-party or factory-based providers?"),n("br"),s(" Use the "),n("strong",null,"Blueprint API"),s(" to register them manually.")],-1),n("div",{class:"language-typescript line-numbers-mode","data-highlighter":"prismjs","data-ext":"ts"},[n("pre",null,[n("code",{class:"language-typescript"},[n("span",{class:"line"},[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" defineBlueprintConfig "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'@stone-js/core'")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" UserProvider "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'./providers/UserProvider'")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"const"),s(" mainBlueprint "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"defineBlueprintConfig"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("blueprint"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("  blueprint"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'stone.providers'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"[")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token punctuation"},"{"),s(" module"),n("span",{class:"token operator"},":"),s(" UserProvider"),n("span",{class:"token punctuation"},","),s(" isFactory"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[s("  "),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"})])]),n("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("p",null,"Each provider entry is an object with:",-1),n("ul",null,[n("li",null,[n("code",null,"module"),s(": the class or factory")]),n("li",null,[n("code",null,"isFactory"),s(": "),n("code",null,"true"),s(" if it’s a factory provider")]),n("li",null,[n("code",null,"isClass"),s(": "),n("code",null,"true"),s(" if it’s a class-based provider")])],-1),n("p",null,"You can mix class-based and factory-based providers here, and even load them dynamically from libraries, conditionally, or by environment.",-1),n("p",null,[n("strong",null,"When to use it:")],-1),n("ul",null,[n("li",null,"When integrating third-party packages"),n("li",null,"When you want lazy or environment-based loading"),n("li",null,"When you don’t want to use decorators")],-1)])),_:1}),e[12]||(e[12]=i(`<p>So in short:</p><table><thead><tr><th>Type</th><th>Supports Hooks</th><th>Easy to Modularize</th><th>Works for 3rd Party</th></tr></thead><tbody><tr><td>Declarative (<code>@Provider()</code>)</td><td>✅</td><td>✅</td><td>⚠️ Needs code access</td></tr><tr><td>Imperative (<code>stone.providers</code>)</td><td>❌</td><td>✅</td><td>✅</td></tr></tbody></table><h2 id="best-practices" tabindex="-1"><a class="header-anchor" href="#best-practices"><span>Best Practices</span></a></h2><p>Service providers are one of the most powerful mechanisms in Stone.js. But with great power comes great modularity. Here’s how to make the most of them, without shooting yourself in the boot phase.</p><h4 id="prefer-declarative-or-blueprint-configuration-first" tabindex="-1"><a class="header-anchor" href="#prefer-declarative-or-blueprint-configuration-first"><span>Prefer Declarative or Blueprint Configuration First</span></a></h4><p>Stone.js is designed to be highly declarative. Whenever possible, configure your system using decorators (<code>@Controller</code>, <code>@Service</code>, <code>@Middleware</code>, etc.) or the <code>defineBlueprintConfig()</code> API.</p><p>Reach for a service provider <strong>only</strong> when:</p><ul><li>You need precise control over the timing and structure of service registration</li><li>You’re integrating advanced logic that decorators or blueprint fields can’t express</li><li>You’re building a reusable <strong>third-party extension</strong> to plug into the initialization phase</li></ul><p>This keeps your system clean, introspectable, and aligned with the Continuum, where configuration is separated by <strong>dimension</strong>, not just by type.</p><h4 id="keep-providers-focused" tabindex="-1"><a class="header-anchor" href="#keep-providers-focused"><span>Keep Providers Focused</span></a></h4><p>Split your logic across <strong>multiple small providers</strong> instead of a giant one.</p><p>Bad:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Provider</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">KitchenSinkProvider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;router&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">DB</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;logger&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;mail&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Mailer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;featureX&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">X</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">&#39;featureY&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">Y</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Good:</p><ul><li><code>RouterProvider</code></li><li><code>DatabaseProvider</code></li><li><code>LoggerProvider</code></li><li><code>FeatureXProvider</code></li><li>...</li></ul><p>This improves reuse, testing, maintainability, and your sanity.</p><h4 id="use-register-to-declare-not-to-execute" tabindex="-1"><a class="header-anchor" href="#use-register-to-declare-not-to-execute"><span>Use <code>register()</code> to declare, not to execute</span></a></h4><p>Your <code>register()</code> method should <strong>only bind</strong> things, never resolve or execute them.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// ❌ Don&#39;t do this in register()</span></span>
<span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ✅ Do this in boot()</span></span>
<span class="line"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Why? Because another provider might not have registered <code>db</code> yet.<br> Let the system finish wiring everything before you flip the switch.</p><h4 id="prefer-class-based-for-complex-behavior" tabindex="-1"><a class="header-anchor" href="#prefer-class-based-for-complex-behavior"><span>Prefer class-based for complex behavior</span></a></h4><p>Need hooks? Need constructor injection? Want to use decorators?</p><p>Then <strong>class-based providers</strong> are your best friend.</p><p>Reserve factory-based providers for:</p><ul><li>Simple one-off modules</li><li>Third-party integration</li><li>If you are doing functional programming</li></ul><h4 id="alias-wisely" tabindex="-1"><a class="header-anchor" href="#alias-wisely"><span>Alias wisely</span></a></h4><p>If you bind a class with a long or verbose name, make it friendlier to use.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>container</span>
<span class="line">  <span class="token punctuation">.</span><span class="token function">singletonIf</span><span class="token punctuation">(</span>LongVerboseHttpClientName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">LongVerboseHttpClientName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span>LongVerboseHttpClientName<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;httpClient&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;axiosClient&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Shorter aliases improve readability and reduce coupling to implementation names.</p><h4 id="use-lifecycle-hooks-for-diagnostics-or-extension" tabindex="-1"><a class="header-anchor" href="#use-lifecycle-hooks-for-diagnostics-or-extension"><span>Use lifecycle hooks for diagnostics or extension</span></a></h4><p>Hooks are not just for fun, they let you:</p><ul><li>Log startup/shutdown</li><li>Add diagnostics</li><li>Trigger async setup steps</li><li>Track errors</li></ul><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Hook</span></span><span class="token punctuation">(</span><span class="token string">&#39;onStart&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">startBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;🔥 System is starting...&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="make-it-reusable" tabindex="-1"><a class="header-anchor" href="#make-it-reusable"><span>Make it reusable</span></a></h4><p>A good provider should be easy to extract into a library or share across apps.</p><ul><li>Avoid hardcoding environment-specific values</li><li>Use config injection (<code>blueprint.get(...)</code>)</li><li>Keep dependencies explicit and controlled</li></ul><p>Your future self, or the next developer, will thank you.</p><h2 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h2><p>While service providers are powerful, they are not the default way to configure your app. Use them when you need control over the <strong>initialization dimension</strong>, and prefer decorators and blueprint-based configuration for everything else.</p><p>Think of providers as your advanced toolkit, precise, low-level, and perfect for libraries or complex orchestration. But for common scenarios, let the Continuum guide you: configure declaratively, and only dive deeper when you must.</p><p>Here’s what to remember:</p><ul><li>A service provider is a <strong>class</strong> or <strong>factory</strong> that implements <code>register()</code> and/or <code>boot()</code></li><li>It lives in the <strong>initialization dimension</strong> of the Continuum Architecture</li><li>It binds services to the <strong>container</strong> during <code>register()</code></li><li>It configures or activates services during <code>boot()</code></li><li>It can listen to <strong>system lifecycle hooks</strong> using decorators</li><li>It can be registered via the <strong>declarative API</strong> (<code>@Provider()</code>) or <strong>imperative API</strong> (<code>stone.providers</code>)</li></ul><p>By organizing your system into clean, focused, reusable providers, you unlock the full power of Stone.js’s modular and scalable architecture.</p><blockquote><p>You don’t “use” Stone.js,<br> You <em>provide</em> it.</p></blockquote>`,44))])}const b=l(k,[["render",h]]),y=JSON.parse('{"path":"/docs/architecture/providers.html","title":"Service Providers","lang":"en-US","frontmatter":{"title":"Service Providers","description":"In Stone.js, Service Providers are the official mechanism for plugging functionality into the initialization dimension, the moment when the system constructs its internal execut...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Service Providers\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-06-07T20:31:21.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr. Stone\\"}]}"],["meta",{"property":"og:url","content":"https://stonejs.com/docs/architecture/providers.html"}],["meta",{"property":"og:site_name","content":"Stone.js"}],["meta",{"property":"og:title","content":"Service Providers"}],["meta",{"property":"og:description","content":"In Stone.js, Service Providers are the official mechanism for plugging functionality into the initialization dimension, the moment when the system constructs its internal execut..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-06-07T20:31:21.000Z"}],["meta",{"property":"article:modified_time","content":"2025-06-07T20:31:21.000Z"}]]},"git":{"createdTime":1749328281000,"updatedTime":1749328281000,"contributors":[{"name":"Mr Stone","username":"","email":"pierre.evens16@gmail.com","commits":1}]},"readingTime":{"minutes":6.63,"words":1990},"filePathRelative":"docs/architecture/providers.md","autoDesc":true}');export{b as comp,y as data};
